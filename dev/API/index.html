<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · PlantGeom.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://VEZY.github.io/PlantGeom.jl/API/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PlantGeom.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Plot recipes</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">MTG diagrams</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../plot_diagram/makie_diagram/">Makie.jl</a></li><li><a class="tocitem" href="../plot_diagram/plots_diagram/">Plots.jl</a></li></ul></li><li><a class="tocitem" href="../makie_3d/">3D Makie recipes</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VEZY/PlantGeom.jl/blob/main/docs/src/API.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><ul><li><a href="#PlantGeom.Material"><code>PlantGeom.Material</code></a></li><li><a href="#PlantGeom.Phong"><code>PlantGeom.Phong</code></a></li><li><a href="#PlantGeom.RefMesh"><code>PlantGeom.RefMesh</code></a></li><li><a href="#PlantGeom.RefMeshes"><code>PlantGeom.RefMeshes</code></a></li><li><a href="#PlantGeom.geometry"><code>PlantGeom.geometry</code></a></li><li><a href="#Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:RefMeshes"><code>Base.:==</code></a></li><li><a href="#Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:PlantGeom.geometry"><code>Base.:==</code></a></li><li><a href="#Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:RefMesh"><code>Base.:==</code></a></li><li><a href="#MeshViz.viz"><code>MeshViz.viz</code></a></li><li><a href="#MeshViz.viz!"><code>MeshViz.viz!</code></a></li><li><a href="#Meshes.nelements-Tuple{RefMesh}"><code>Meshes.nelements</code></a></li><li><a href="#Meshes.nelements-Tuple{RefMeshes}"><code>Meshes.nelements</code></a></li><li><a href="#Meshes.nvertices-Tuple{RefMeshes}"><code>Meshes.nvertices</code></a></li><li><a href="#Meshes.nvertices-Tuple{RefMesh}"><code>Meshes.nvertices</code></a></li><li><a href="#PlantGeom.align_ref_meshes-Tuple{RefMeshes}"><code>PlantGeom.align_ref_meshes</code></a></li><li><a href="#PlantGeom.attributes_to_xml-NTuple{4, Any}"><code>PlantGeom.attributes_to_xml</code></a></li><li><a href="#PlantGeom.color_type-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Symbol"><code>PlantGeom.color_type</code></a></li><li><a href="#PlantGeom.colorant_to_string-Tuple{T} where T&lt;:ColorTypes.RGBA"><code>PlantGeom.colorant_to_string</code></a></li><li><a href="#PlantGeom.colorbar-Tuple{Any, Any}"><code>PlantGeom.colorbar</code></a></li><li><a href="#PlantGeom.coordinates!-Tuple{Any}"><code>PlantGeom.coordinates!</code></a></li><li><a href="#PlantGeom.diagram"><code>PlantGeom.diagram</code></a></li><li><a href="#PlantGeom.diagram!"><code>PlantGeom.diagram!</code></a></li><li><a href="#PlantGeom.extend_pos-NTuple{5, Any}"><code>PlantGeom.extend_pos</code></a></li><li><a href="#PlantGeom.get_attr_type-Tuple{Any}"><code>PlantGeom.get_attr_type</code></a></li><li><a href="#PlantGeom.get_color-Union{Tuple{T}, Tuple{T, Any}, Tuple{T, Any, Nothing}} where T&lt;:AbstractArray"><code>PlantGeom.get_color</code></a></li><li><a href="#PlantGeom.get_colormap-Tuple{Any}"><code>PlantGeom.get_colormap</code></a></li><li><a href="#PlantGeom.get_mtg_color-Tuple{Any, Any}"><code>PlantGeom.get_mtg_color</code></a></li><li><a href="#PlantGeom.get_ref_mesh_index"><code>PlantGeom.get_ref_mesh_index</code></a></li><li><a href="#PlantGeom.get_ref_mesh_index!"><code>PlantGeom.get_ref_mesh_index!</code></a></li><li><a href="#PlantGeom.get_ref_meshes-Tuple{Any}"><code>PlantGeom.get_ref_meshes</code></a></li><li><a href="#PlantGeom.get_ref_meshes_color-Tuple{RefMeshes}"><code>PlantGeom.get_ref_meshes_color</code></a></li><li><a href="#PlantGeom.map_coord-Tuple{Any, Any, Any}"><code>PlantGeom.map_coord</code></a></li><li><a href="#PlantGeom.materialBDD_to_material-Tuple{Any}"><code>PlantGeom.materialBDD_to_material</code></a></li><li><a href="#PlantGeom.material_to_opf_string-Tuple{Phong}"><code>PlantGeom.material_to_opf_string</code></a></li><li><a href="#PlantGeom.meshBDD_to_meshes-Tuple{Any}"><code>PlantGeom.meshBDD_to_meshes</code></a></li><li><a href="#PlantGeom.mtg_coordinates_df"><code>PlantGeom.mtg_coordinates_df</code></a></li><li><a href="#PlantGeom.mtg_to_opf_link-Tuple{Any}"><code>PlantGeom.mtg_to_opf_link</code></a></li><li><a href="#PlantGeom.mtg_topology_to_xml!"><code>PlantGeom.mtg_topology_to_xml!</code></a></li><li><a href="#PlantGeom.normals_vertex-Tuple{RefMesh}"><code>PlantGeom.normals_vertex</code></a></li><li><a href="#PlantGeom.parse_geometry-Tuple{Any}"><code>PlantGeom.parse_geometry</code></a></li><li><a href="#PlantGeom.parse_materialBDD!-Tuple{Any}"><code>PlantGeom.parse_materialBDD!</code></a></li><li><a href="#PlantGeom.parse_meshBDD!-Tuple{Any}"><code>PlantGeom.parse_meshBDD!</code></a></li><li><a href="#PlantGeom.parse_opf_array"><code>PlantGeom.parse_opf_array</code></a></li><li><a href="#PlantGeom.parse_opf_attributeBDD!-Tuple{Any}"><code>PlantGeom.parse_opf_attributeBDD!</code></a></li><li><a href="#PlantGeom.parse_opf_elements!-Tuple{Any, Any}"><code>PlantGeom.parse_opf_elements!</code></a></li><li><a href="#PlantGeom.parse_opf_topology!-NTuple{6, Any}"><code>PlantGeom.parse_opf_topology!</code></a></li><li><a href="#PlantGeom.parse_ref_meshes-Tuple{Any}"><code>PlantGeom.parse_ref_meshes</code></a></li><li><a href="#PlantGeom.plot_opf-Tuple{Any}"><code>PlantGeom.plot_opf</code></a></li><li><a href="#PlantGeom.read_opf"><code>PlantGeom.read_opf</code></a></li><li><a href="#PlantGeom.refmesh_to_mesh"><code>PlantGeom.refmesh_to_mesh</code></a></li><li><a href="#PlantGeom.refmesh_to_mesh!"><code>PlantGeom.refmesh_to_mesh!</code></a></li><li><a href="#PlantGeom.rotate_point-NTuple{5, Any}"><code>PlantGeom.rotate_point</code></a></li><li><a href="#PlantGeom.taper-Tuple{Any, Any, Any}"><code>PlantGeom.taper</code></a></li><li><a href="#PlantGeom.transform_mesh!-Tuple{MultiScaleTreeGraph.Node, Any}"><code>PlantGeom.transform_mesh!</code></a></li><li><a href="#PlantGeom.write_opf-Tuple{Any, Any}"><code>PlantGeom.write_opf</code></a></li><li><a href="#PlantGeom.xmax"><code>PlantGeom.xmax</code></a></li><li><a href="#PlantGeom.xmin"><code>PlantGeom.xmin</code></a></li><li><a href="#PlantGeom.ymax"><code>PlantGeom.ymax</code></a></li><li><a href="#PlantGeom.ymin"><code>PlantGeom.ymin</code></a></li><li><a href="#PlantGeom.zmax"><code>PlantGeom.zmax</code></a></li><li><a href="#PlantGeom.zmin"><code>PlantGeom.zmin</code></a></li><li><a href="#RecipesBase.plot"><code>RecipesBase.plot</code></a></li><li><a href="#RecipesBase.plot!"><code>RecipesBase.plot!</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.Material" href="#PlantGeom.Material"><code>PlantGeom.Material</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A material for the illumination model (e.g. Phong illumination).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.Phong" href="#PlantGeom.Phong"><code>PlantGeom.Phong</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Data structure for a mesh material that is used to describe the light components of a <a href="https://en.wikipedia.org/wiki/Phong_reflection_model">Phong reflection</a> type model. All data is stored as RGBα for Red, Green, Blue and transparency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L7-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.RefMesh" href="#PlantGeom.RefMesh"><code>PlantGeom.RefMesh</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RefMesh(
    name::S
    mesh::SimpleMesh
    normals::N
    texture_coords::T
    material::M
    taper::Bool
)

RefMesh(name, mesh, material = RGB(220 / 255, 220 / 255, 220 / 255))</code></pre><p>RefMesh type. Stores all information about a Mesh:</p><ul><li><code>name::S</code>: the mesh name</li><li><code>mesh::SimpleMesh</code>: the actual mesh information -&gt; points and topology</li><li><code>normals::Vector{Float64}</code>: the normals, given as a vector of x1,y1,z1,x2,y2,z2...</li><li><code>texture_coords::Vector{Float64}</code>: the texture coordinates (not used yet), idem, a vector</li><li><code>material::M</code>: the material, used to set the shading</li><li><code>taper::Bool</code>: <code>true</code> if tapering is enabled</li></ul><p>The reference meshes are then transformed on each node of the MTG using a transformation matrix to match the actual mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L59-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.RefMeshes" href="#PlantGeom.RefMeshes"><code>PlantGeom.RefMeshes</code></a> — <span class="docstring-category">Type</span></header><section><div><p>RefMeshes type. Data base that stores all <a href="#PlantGeom.RefMesh"><code>RefMesh</code></a> in an MTG. Usually stored in the <code>:ref_meshes</code> attribute of the root node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L106-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.geometry" href="#PlantGeom.geometry"><code>PlantGeom.geometry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">geometry(
    ref_mesh::M
    ref_mesh_index::Union{Int,Nothing}
    transformation::T
    dUp::S
    dDwn::S
    mesh::Union{SimpleMesh,Nothing}
)</code></pre><p>A Node geometry with the reference mesh, its transformation matrix and optionnally the index of the reference mesh in the reference meshes data base (see notes) and the resulting mesh (optional to save memory).</p><p><strong>Note</strong></p><p>The ref<em>mesh usually points to a <a href="#PlantGeom.RefMesh"><code>RefMesh</code></a> stored in the `:ref</em>meshes` attribute of the root node of the MTG.</p><p>Although optional, storing the index of the reference mesh (<code>ref_mesh_index</code>) in the database allows a faster writing of the MTG as an OPF to disk.</p><p>If no transformation matrix is needed, you can use <code>I</code> from the Linear Algebra package (lazy)</p><p>The <code>transformation</code> field should be a <code>CoordinateTransformations.jl</code>&#39;s transformation. In case no transformation is needed, use <code>IdentityTransformation()</code>. If you already have the transformation matrix, you can pass it to <code>LinearMap()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L116-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:PlantGeom.geometry" href="#Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:PlantGeom.geometry"><code>Base.:==</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">==(a::geometry, b::geometry)</code></pre><p>Test RefMeshes equality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/equality.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:RefMesh" href="#Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:RefMesh"><code>Base.:==</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">==(a::RefMesh, b::RefMesh)</code></pre><p>Test RefMesh equality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/equality.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:RefMeshes" href="#Base.:==-Union{Tuple{T}, Tuple{T, T}} where T&lt;:RefMeshes"><code>Base.:==</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">==(a::RefMeshes, b::RefMeshes)</code></pre><p>Test RefMeshes equality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/equality.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MeshViz.viz" href="#MeshViz.viz"><code>MeshViz.viz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">viz(opf::MultiScaleTreeGraph.Node; kwargs...)
viz!(opf::MultiScaleTreeGraph.Node; kwargs...)</code></pre><p>Vizualise the 3D geometry of an MTG (usually read from an OPF). This function search for the <code>:geometry</code> attribute in each node of the MTG, and build the vizualisation using the <code>mesh</code> field, or the reference meshes and the associated transformation matrix if missing.</p><p>The <code>:geometry</code> attribute is usually added by the <code>refmesh_to_mesh!</code> function first, which can be called with the <code>transform!</code> function. See the examples below.</p><p><strong>Arguments</strong></p><ul><li><code>opf</code>: The MTG to be vizualised.</li><li><code>kwargs</code>: Additional arguments to be passed to <code>viz!</code>, wich includes: <ul><li><code>color</code>: The color to be used for the plot. Can be a colorant, an attribute of the MTG (given as a Symbol), or a dictionary of colors for each reference mesh.</li><li><code>colorscheme</code>: The colorscheme to be used for the plot. Can be a Symbol or a ColorScheme. </li><li><code>facetcolor</code>: The color to be used for the facets. Should be a colorant or a symbol of color.</li><li><code>showfacets</code>: A boolean indicating whether the facets should be shown or not.</li><li><code>color_missing</code>: The color to be used for missing values. Should be a colorant or a symbol of color.</li><li><code>color_vertex</code>: A boolean indicating whether the values in <code>color</code> (if colored by attributes) are defined for each vertex of the mesh, or for each mesh.</li><li><code>index</code>: An integer giving the index of the attribute value to be vizualised. This is useful when the attribute is a vector of values for <em>e.g.</em> each timestep.</li><li><code>color_cache_name</code>: The name of the color cache. Should be a string (default to a random string).</li></ul></li></ul><p>Note that <code>color_vertex</code> is set to <code>false</code> by default.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using MultiScaleTreeGraph, PlantGeom, GLMakie

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)

opf = read_opf(file)
viz(opf)

# If you need to plot the opf several times, you better cache the mesh in the node geometry
# like so:
transform!(opf, refmesh_to_mesh!)

# Then plot it again like before, and it will be faster:
viz(opf)

# We can also color the 3d plot with several options:
# With one shared color:
viz(opf, color = :red)
# One color per reference mesh:
viz(opf, color = Dict(1 =&gt; :burlywood4, 2 =&gt; :springgreen4, 3 =&gt; :burlywood4))

# Or just changing the color of some:
viz(opf, color = Dict(1 =&gt; :burlywood4))

# Or coloring by opf attribute, e.g. using the mesh max Z coordinates (NB: need to use
# `refmesh_to_mesh!` before, see above):
transform!(opf, :geometry =&gt; (x -&gt; zmax(x.mesh)) =&gt; :z_max, ignore_nothing = true)
viz(opf, color = :z_max)

# One color for each vertex of the refmesh 1:
using Meshes
vertex_color = get_color(1:nvertices(get_ref_meshes(opf))[1], [1,nvertices(get_ref_meshes(opf))[1]])
viz(opf, color = Dict(1 =&gt; vertex_color))

# Or even coloring by the value of the Z coordinates of each vertex:
transform!(opf, :geometry =&gt; (x -&gt; [i.coords[3] for i in x.mesh.vertices]) =&gt; :z, ignore_nothing = true)
viz(opf, color = :z, showfacets = true)

f,a,p = viz(opf, color = :z, showfacets = true)
p[:color] = :Length</code></pre><pre><code class="nohighlight hljs">viz!(ref_meshes; kwargs...)</code></pre><p>Plot all reference meshes in a single 3d plot using Makie.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom, GLMakie

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)
meshes = get_ref_meshes(opf)

viz(meshes)
# With one shared color:
viz(meshes, color = :green)
# One color per reference mesh:
viz(meshes, color = Dict(1 =&gt; :burlywood4, 2 =&gt; :springgreen4, 3 =&gt; :burlywood4))
# Or just changing the color of some:
viz(meshes, color = Dict(1 =&gt; :burlywood4, 3 =&gt; :burlywood4))
# One color for each vertex of the refmesh 0:
viz(meshes, color = Dict(2 =&gt; 1:nvertices(meshes)[2]))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/opf_recipe.jl#L3-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MeshViz.viz!" href="#MeshViz.viz!"><code>MeshViz.viz!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">viz(opf::MultiScaleTreeGraph.Node; kwargs...)
viz!(opf::MultiScaleTreeGraph.Node; kwargs...)</code></pre><p>Vizualise the 3D geometry of an MTG (usually read from an OPF). This function search for the <code>:geometry</code> attribute in each node of the MTG, and build the vizualisation using the <code>mesh</code> field, or the reference meshes and the associated transformation matrix if missing.</p><p>The <code>:geometry</code> attribute is usually added by the <code>refmesh_to_mesh!</code> function first, which can be called with the <code>transform!</code> function. See the examples below.</p><p><strong>Arguments</strong></p><ul><li><code>opf</code>: The MTG to be vizualised.</li><li><code>kwargs</code>: Additional arguments to be passed to <code>viz!</code>, wich includes: <ul><li><code>color</code>: The color to be used for the plot. Can be a colorant, an attribute of the MTG (given as a Symbol), or a dictionary of colors for each reference mesh.</li><li><code>colorscheme</code>: The colorscheme to be used for the plot. Can be a Symbol or a ColorScheme. </li><li><code>facetcolor</code>: The color to be used for the facets. Should be a colorant or a symbol of color.</li><li><code>showfacets</code>: A boolean indicating whether the facets should be shown or not.</li><li><code>color_missing</code>: The color to be used for missing values. Should be a colorant or a symbol of color.</li><li><code>color_vertex</code>: A boolean indicating whether the values in <code>color</code> (if colored by attributes) are defined for each vertex of the mesh, or for each mesh.</li><li><code>index</code>: An integer giving the index of the attribute value to be vizualised. This is useful when the attribute is a vector of values for <em>e.g.</em> each timestep.</li><li><code>color_cache_name</code>: The name of the color cache. Should be a string (default to a random string).</li></ul></li></ul><p>Note that <code>color_vertex</code> is set to <code>false</code> by default.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using MultiScaleTreeGraph, PlantGeom, GLMakie

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)

opf = read_opf(file)
viz(opf)

# If you need to plot the opf several times, you better cache the mesh in the node geometry
# like so:
transform!(opf, refmesh_to_mesh!)

# Then plot it again like before, and it will be faster:
viz(opf)

# We can also color the 3d plot with several options:
# With one shared color:
viz(opf, color = :red)
# One color per reference mesh:
viz(opf, color = Dict(1 =&gt; :burlywood4, 2 =&gt; :springgreen4, 3 =&gt; :burlywood4))

# Or just changing the color of some:
viz(opf, color = Dict(1 =&gt; :burlywood4))

# Or coloring by opf attribute, e.g. using the mesh max Z coordinates (NB: need to use
# `refmesh_to_mesh!` before, see above):
transform!(opf, :geometry =&gt; (x -&gt; zmax(x.mesh)) =&gt; :z_max, ignore_nothing = true)
viz(opf, color = :z_max)

# One color for each vertex of the refmesh 1:
using Meshes
vertex_color = get_color(1:nvertices(get_ref_meshes(opf))[1], [1,nvertices(get_ref_meshes(opf))[1]])
viz(opf, color = Dict(1 =&gt; vertex_color))

# Or even coloring by the value of the Z coordinates of each vertex:
transform!(opf, :geometry =&gt; (x -&gt; [i.coords[3] for i in x.mesh.vertices]) =&gt; :z, ignore_nothing = true)
viz(opf, color = :z, showfacets = true)

f,a,p = viz(opf, color = :z, showfacets = true)
p[:color] = :Length</code></pre><pre><code class="nohighlight hljs">viz!(ref_meshes; kwargs...)</code></pre><p>Plot all reference meshes in a single 3d plot using Makie.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom, GLMakie

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)
meshes = get_ref_meshes(opf)

viz(meshes)
# With one shared color:
viz(meshes, color = :green)
# One color per reference mesh:
viz(meshes, color = Dict(1 =&gt; :burlywood4, 2 =&gt; :springgreen4, 3 =&gt; :burlywood4))
# Or just changing the color of some:
viz(meshes, color = Dict(1 =&gt; :burlywood4, 3 =&gt; :burlywood4))
# One color for each vertex of the refmesh 0:
viz(meshes, color = Dict(2 =&gt; 1:nvertices(meshes)[2]))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/opf_recipe.jl#L3-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Meshes.nelements-Tuple{RefMeshes}" href="#Meshes.nelements-Tuple{RefMeshes}"><code>Meshes.nelements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nelements(meshes::RefMeshes)</code></pre><p>Return the number of elements for each reference mesh as a vector of nelements</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/helpers.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Meshes.nelements-Tuple{RefMesh}" href="#Meshes.nelements-Tuple{RefMesh}"><code>Meshes.nelements</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nelements(meshes::RefMeshes)</code></pre><p>Return the number of elements of a reference mesh</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/helpers.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Meshes.nvertices-Tuple{RefMeshes}" href="#Meshes.nvertices-Tuple{RefMeshes}"><code>Meshes.nvertices</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nvertices(meshes::RefMeshes)</code></pre><p>Return the number of vertices for each reference mesh as a vector of nvertices</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/helpers.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Meshes.nvertices-Tuple{RefMesh}" href="#Meshes.nvertices-Tuple{RefMesh}"><code>Meshes.nvertices</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nvertices(meshes::RefMesh)</code></pre><p>Return the number of vertices of a reference mesh</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/helpers.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.align_ref_meshes-Tuple{RefMeshes}" href="#PlantGeom.align_ref_meshes-Tuple{RefMeshes}"><code>PlantGeom.align_ref_meshes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">align_ref_meshes(meshes::RefMeshes)</code></pre><p>Align all reference meshes along the X axis. Used for visualisation only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L146-L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.attributes_to_xml-NTuple{4, Any}" href="#PlantGeom.attributes_to_xml-NTuple{4, Any}"><code>PlantGeom.attributes_to_xml</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">attributes_to_xml(node, xml_parent)</code></pre><p>Write an MTG node into an XML node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/write_opf.jl#L224-L228">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.color_type-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Symbol" href="#PlantGeom.color_type-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Symbol"><code>PlantGeom.color_type</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">color_type(color, opf)</code></pre><p>Return the type of the color, whether it is an attribute, a colorant, or a RefMeshColorant.</p><p><strong>Arguments</strong></p><ul><li><code>color</code>: The color to be checked.</li><li><code>opf</code>: The MTG to be plotted.</li></ul><p><strong>Returns</strong></p><ul><li><code>RefMeshColorant</code>: If the color is :slategray3, then it is the default color given by MeshViz,</li></ul><p>so we assume nothing was passed by the user and color by reference mesh instead.</p><ul><li><code>AttributeColorant</code>: If the color is an attribute of the MTG, then we color by that attribute.</li><li><code>T</code>: If the color is a colorant, then we color everything by that color.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using MultiScaleTreeGraph, PlantGeom, Colors

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)

opf = read_opf(file)

# Colors:
color_type(:red, opf)
color_type(RGB(0.1,0.5,0.1), opf)

# Attributes:
color_type(:Length, opf)

# Default color:
color_type(:slategray3, opf)

# Dict of colors:
color_type(Dict(1=&gt;RGB(0.1,0.5,0.1), 2=&gt;RGB(0.5,0.1,0.1)), opf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/colors/get_color_type.jl#L20-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.colorant_to_string-Tuple{T} where T&lt;:ColorTypes.RGBA" href="#PlantGeom.colorant_to_string-Tuple{T} where T&lt;:ColorTypes.RGBA"><code>PlantGeom.colorant_to_string</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">colorant_to_string(x)</code></pre><p>Parse a geometry material for OPF writing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.colorbar-Tuple{Any, Any}" href="#PlantGeom.colorbar-Tuple{Any, Any}"><code>PlantGeom.colorbar</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">colorbar(parent, plotobject, kwargs...)</code></pre><p>Add a colorbar based on the attribute chose to color the plot. plotobject must be a plot of an MTG colored by an attribute. Use Makie.Colorbar for any other use case instead.</p><p><strong>Arguments</strong></p><ul><li><code>parent</code>: parent scene</li><li><code>plotobject</code>: plot object to add the colorbar to</li><li><code>kwargs</code>: keyword arguments to pass to Makie.Colorbar</li></ul><p><strong>Example</strong></p><p>```julia using GLMakie, MultiScaleTreeGraph, PlantGeom file = joinpath(dirname(dirname(pathof(PlantGeom))), &quot;test&quot;, &quot;files&quot;, &quot;simple<em>plant.opf&quot;) opf = read</em>opf(file)</p><p>f, ax, p = viz(opf, color=:Length) colorbar(f[1, 2], p) f</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/colors/colorbar.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.coordinates!-Tuple{Any}" href="#PlantGeom.coordinates!-Tuple{Any}"><code>PlantGeom.coordinates!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">coordinates!(mtg; angle = 45; force = false)</code></pre><p>Compute dummy 3d coordinates for the mtg nodes using an alterning phyllotaxy. Used when coordinates are missing. Coordinates are just node attributes with reserved names: :XX, :YY and :ZZ.</p><p><strong>Returns</strong></p><p>Nothing, mutates the mtg in-place (adds :XX, :YY and :ZZ to nodes).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.mtg&quot;)
mtg = read_mtg(file)
coordinates!(mtg)
DataFrame(mtg, [:XX, :YY, :ZZ])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/mtg_recipe_helpers.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.diagram" href="#PlantGeom.diagram"><code>PlantGeom.diagram</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diagram(opf::MultiScaleTreeGraph.Node; kwargs...)
diagram!(opf::MultiScaleTreeGraph.Node; kwargs...)</code></pre><p>Make a diagram of the MTG tree, paired with a <code>Makie.jl</code> backend.</p><p>See also <a href="@ref"><code>apply_recipe</code></a> for the same plot with a <code>Plots.jl</code> backend.</p><p>The main attributes are:</p><ul><li>color: the color of the nodes</li><li>colormap: the colormap used if the color uses an attribute. By default it uses viridis.</li></ul><p>Must be a ColorScheme from <a href="https://juliagraphics.github.io/ColorSchemes.jl/stable/basics/">ColorSchemes</a> or a Symbol with its name.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom, GLMakie

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)

opf = read_opf(file)

diagram(opf)

# We can also color the 3d plot with several options:
# With one shared color:
diagram(opf, color = :red)

# Or colouring by opf attribute, *e.g.* using the nodes Z coordinates:
diagram(opf, color = :ZZ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/mtg_tree_recipe.jl#L12-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.diagram!" href="#PlantGeom.diagram!"><code>PlantGeom.diagram!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diagram(opf::MultiScaleTreeGraph.Node; kwargs...)
diagram!(opf::MultiScaleTreeGraph.Node; kwargs...)</code></pre><p>Make a diagram of the MTG tree, paired with a <code>Makie.jl</code> backend.</p><p>See also <a href="@ref"><code>apply_recipe</code></a> for the same plot with a <code>Plots.jl</code> backend.</p><p>The main attributes are:</p><ul><li>color: the color of the nodes</li><li>colormap: the colormap used if the color uses an attribute. By default it uses viridis.</li></ul><p>Must be a ColorScheme from <a href="https://juliagraphics.github.io/ColorSchemes.jl/stable/basics/">ColorSchemes</a> or a Symbol with its name.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom, GLMakie

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)

opf = read_opf(file)

diagram(opf)

# We can also color the 3d plot with several options:
# With one shared color:
diagram(opf, color = :red)

# Or colouring by opf attribute, *e.g.* using the nodes Z coordinates:
diagram(opf, color = :ZZ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/mtg_tree_recipe.jl#L12-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.extend_pos-NTuple{5, Any}" href="#PlantGeom.extend_pos-NTuple{5, Any}"><code>PlantGeom.extend_pos</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Add a new point after (x1,y1) using same direction and length relative to it</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/mtg_recipe_helpers.jl#L103-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_attr_type-Tuple{Any}" href="#PlantGeom.get_attr_type-Tuple{Any}"><code>PlantGeom.get_attr_type</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get the attributes types in Julia <code>DataType</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L274-L276">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_color-Union{Tuple{T}, Tuple{T, Any}, Tuple{T, Any, Nothing}} where T&lt;:AbstractArray" href="#PlantGeom.get_color-Union{Tuple{T}, Tuple{T, Any}, Tuple{T, Any, Nothing}} where T&lt;:AbstractArray"><code>PlantGeom.get_color</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_color(var &lt;: AbstractArray, range_var, colormap=colorschemes[:viridis])
get_color(var, range_var, colormap=colorschemes[:viridis])</code></pre><p>Map value(s) to colors from a colormap based on a range of values</p><p><strong>Arguments</strong></p><ul><li><code>var</code>: value(s) to map to colors</li><li><code>range_var</code>: range of values to map to colors</li><li><code>colormap</code>: colormap to use</li></ul><p><strong>Returns</strong></p><ul><li><code>color</code>: color(s) corresponding to <code>var</code></li></ul><p><strong>Examples</strong></p><p>```julia using Colors</p><p>get<em>color(1, 1:2, colormap = colorschemes[:viridis]) # returns RGB{N0f8}(0.267004,0.00487433,0.329415) get</em>color(1:2, 1:10, colormap = colorschemes[:viridis]) # returns RGB{N0f8}(0.267004,0.00487433,0.329415) get_color(1:2, 1:10, 1, colormap = colorschemes[:viridis]) # returns RGB{N0f8}(0.267004,0.00487433,0.329415)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/colors/colors.jl#L18-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_colormap-Tuple{Any}" href="#PlantGeom.get_colormap-Tuple{Any}"><code>PlantGeom.get_colormap</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_colormap(colormap)</code></pre><p>Get the colormap as a ColorScheme if it is a named color or ColorScheme</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/colors/colors.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_mtg_color-Tuple{Any, Any}" href="#PlantGeom.get_mtg_color-Tuple{Any, Any}"><code>PlantGeom.get_mtg_color</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_mtg_color(color, opf)</code></pre><p>Return the color to be used for the plot.</p><p><strong>Arguments</strong></p><ul><li><code>color</code>: The color to be checked.</li><li><code>opf</code>: The MTG to be plotted.</li></ul><p><strong>Returns</strong></p><p>The color to be used for the plot.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using MultiScaleTreeGraph, PlantGeom, Colors
file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)

get_mtg_color(:red, opf)
get_mtg_color(RGB(0.1,0.5,0.1), opf)
get_mtg_color(:Length, opf)
get_mtg_color(:slategray3, opf)
get_mtg_color(Dict(1=&gt;RGB(0.1,0.5,0.1), 2=&gt;RGB(0.1,0.1,0.5)), opf)
get_mtg_color(Dict(1 =&gt; :burlywood4, 2 =&gt; :springgreen4), opf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/colors/get_mtg_color.jl#L21-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_ref_mesh_index" href="#PlantGeom.get_ref_mesh_index"><code>PlantGeom.get_ref_mesh_index</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_ref_mesh_index!(node, ref_meshes = get_ref_meshes(node))
get_ref_mesh_index(node, ref_meshes = get_ref_meshes(node))</code></pre><p>Get the index of the reference mesh used in the current node.</p><p><strong>Notes</strong></p><p>Please use the <code>ref_meshes</code> argument preferably as not giving it make the function visit the root node each time otherwise, and it can become a limitation when traversing a big MTG.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L50-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_ref_mesh_index!" href="#PlantGeom.get_ref_mesh_index!"><code>PlantGeom.get_ref_mesh_index!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_ref_mesh_index!(node, ref_meshes = get_ref_meshes(node))
get_ref_mesh_index(node, ref_meshes = get_ref_meshes(node))</code></pre><p>Get the index of the reference mesh used in the current node.</p><p><strong>Notes</strong></p><p>Please use the <code>ref_meshes</code> argument preferably as not giving it make the function visit the root node each time otherwise, and it can become a limitation when traversing a big MTG.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L50-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_ref_meshes-Tuple{Any}" href="#PlantGeom.get_ref_meshes-Tuple{Any}"><code>PlantGeom.get_ref_meshes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_ref_meshes(mtg)</code></pre><p>Get all reference meshes from an mtg, usually from an OPF.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom
file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)
meshes = get_ref_meshes(opf)

using GLMakie
viz(meshes)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.get_ref_meshes_color-Tuple{RefMeshes}" href="#PlantGeom.get_ref_meshes_color-Tuple{RefMeshes}"><code>PlantGeom.get_ref_meshes_color</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_ref_meshes_color(meshes::RefMeshes)</code></pre><p>Get the reference meshes colors (only the diffuse part for now).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using MultiScaleTreeGraph, PlantGeom
file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)
meshes = get_ref_meshes(opf)
PlantGeom.get_ref_meshes_color(meshes)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L171-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.map_coord-Tuple{Any, Any, Any}" href="#PlantGeom.map_coord-Tuple{Any, Any, Any}"><code>PlantGeom.map_coord</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">map_coord(f, mesh, coord)</code></pre><p>Apply function <code>f</code> over the mesh coordinates <code>coord</code>. Values for <code>coord</code> can be 1 for x, 2 for y and 3 for z.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L33-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.materialBDD_to_material-Tuple{Any}" href="#PlantGeom.materialBDD_to_material-Tuple{Any}"><code>PlantGeom.materialBDD_to_material</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse a material in opf format to a <a href="#PlantGeom.Phong"><code>Phong</code></a> material.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L132-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.material_to_opf_string-Tuple{Phong}" href="#PlantGeom.material_to_opf_string-Tuple{Phong}"><code>PlantGeom.material_to_opf_string</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">material_to_opf_string(material::Phong)
material_to_opf_string(material::Colorant)</code></pre><p>Format a material into a Dict for OPF writting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/structs.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.meshBDD_to_meshes-Tuple{Any}" href="#PlantGeom.meshBDD_to_meshes-Tuple{Any}"><code>PlantGeom.meshBDD_to_meshes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">meshBDD_to_meshes(x)</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using MultiScaleTreeGraph
file = joinpath(dirname(dirname(pathof(MultiScaleTreeGraph))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)
meshBDD_to_meshes(opf.attributes[:meshBDD])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L99-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.mtg_coordinates_df" href="#PlantGeom.mtg_coordinates_df"><code>PlantGeom.mtg_coordinates_df</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mtg_coordinates_df(mtg, attr; force = false)
mtg_coordinates_df!(mtg, attr; force = false)</code></pre><p>Extract the coordinates of the nodes of the mtg and the coordinates of their parents (:XX<em>from, :YY</em>from, :ZZ_from) and output a DataFrame. Optionally you can also provide an attribute to add to the output DataFrame too by passing its name as a symbol to <code>attr</code>.</p><p>The coordinates are computed using <a href="#PlantGeom.coordinates!-Tuple{Any}"><code>coordinates!</code></a> if missing, or if <code>force = true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/mtg_recipe_helpers.jl#L130-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.mtg_to_opf_link-Tuple{Any}" href="#PlantGeom.mtg_to_opf_link-Tuple{Any}"><code>PlantGeom.mtg_to_opf_link</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mtg_to_opf_link(link)</code></pre><p>Takes an MTG link as input (&quot;/&quot;, &quot;&lt;&quot; or &quot;+&quot;) and outputs its corresponding link as declared in the OPF format (&quot;decomp&quot;, &quot;follow&quot; or &quot;branch&quot;)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/write_opf.jl#L187-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.mtg_topology_to_xml!" href="#PlantGeom.mtg_topology_to_xml!"><code>PlantGeom.mtg_topology_to_xml!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mtg_topology_to_xml!(node, xml_parent)</code></pre><p>Write the MTG topology, attributes and geometry into XML format. This function is used to write the &quot;topology&quot; section of the OPF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/write_opf.jl#L204-L209">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.normals_vertex-Tuple{RefMesh}" href="#PlantGeom.normals_vertex-Tuple{RefMesh}"><code>PlantGeom.normals_vertex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">normals_vertex(mesh::Meshes.SimpleMesh)</code></pre><p>Compute per vertex normals and return them as a <code>StaticArrays.SVector</code>.</p><p>#! This is a naive approach because I have no time right know. #! We just put the face mesh as a vertex mesh (and ovewritting values for common points)</p><p><strong>TODO: Use a real computation instead. See e.g.:</strong></p><p><strong>https://stackoverflow.com/questions/45477806/general-method-for-calculating-smooth-vertex-normals-with-100-smoothness?noredirect=1&amp;lq=1</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/helpers.jl#L30-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_geometry-Tuple{Any}" href="#PlantGeom.parse_geometry-Tuple{Any}"><code>PlantGeom.parse_geometry</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse the geometry element of the OPF.</p><p><strong>Note</strong></p><p>The transformation matrix is 3*4. elem = elem.content</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L296-L302">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_materialBDD!-Tuple{Any}" href="#PlantGeom.parse_materialBDD!-Tuple{Any}"><code>PlantGeom.parse_materialBDD!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse the materialBDD using <a href="#PlantGeom.parse_opf_elements!-Tuple{Any, Any}"><code>parse_opf_elements!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L216-L218">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_meshBDD!-Tuple{Any}" href="#PlantGeom.parse_meshBDD!-Tuple{Any}"><code>PlantGeom.parse_meshBDD!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse the meshBDD using <a href="#PlantGeom.parse_opf_array"><code>parse_opf_array</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L160-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_opf_array" href="#PlantGeom.parse_opf_array"><code>PlantGeom.parse_opf_array</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Parse an array of values from the OPF into a Julia array (Arrays in OPFs are not following XML recommendations)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L128-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_opf_attributeBDD!-Tuple{Any}" href="#PlantGeom.parse_opf_attributeBDD!-Tuple{Any}"><code>PlantGeom.parse_opf_attributeBDD!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parse the opf attributes as a Dict.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L263-L265">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_opf_elements!-Tuple{Any, Any}" href="#PlantGeom.parse_opf_elements!-Tuple{Any, Any}"><code>PlantGeom.parse_opf_elements!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Generic parser for OPF elements.</p><p><strong>Arguments</strong></p><ul><li><code>opf::OrderedDict</code>: the opf Dict (using [XMLDict.xml_dict])</li><li><code>elem_types::Array</code>: the target types of the element (e.g. &quot;[String, Int64]&quot;)</li></ul><p><strong>Details</strong></p><p><code>elem_types</code> should be of the same length as the number of elements found in each item of the subchild. elem_types = [Float64, Float64, Float64, Float64, Float64, Float64]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L234-L247">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_opf_topology!-NTuple{6, Any}" href="#PlantGeom.parse_opf_topology!-NTuple{6, Any}"><code>PlantGeom.parse_opf_topology!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Parser for OPF topology.</p><p><strong>Note</strong></p><p>The transformation matrices in <code>geometry</code> are 3*4. parse<em>opf</em>topology!(elem, node<em>i, features) node = elem mtg = node</em>i features = get<em>attr</em>type(opf_attr[:attributeBDD])</p><p><strong>Debugging:</strong></p><p>mtg = nothing</p><p>node = elem mtg = node<em>i parse</em>opf<em>topology!(                 node,                 nothing,                 get</em>attr<em>type(opf</em>attr[:attributeBDD]),                 attr<em>type,                 mtg</em>type,                 ref_meshes             )</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L320-L344">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.parse_ref_meshes-Tuple{Any}" href="#PlantGeom.parse_ref_meshes-Tuple{Any}"><code>PlantGeom.parse_ref_meshes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">parse_ref_meshes(mtg)</code></pre><p>Parse the reference meshes of an OPF into RefMeshes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/reference_meshes.jl#L64-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.plot_opf-Tuple{Any}" href="#PlantGeom.plot_opf-Tuple{Any}"><code>PlantGeom.plot_opf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot_opf(plot)</code></pre><p>Actual workhorse function for plotting an OPF / MTG with geometry.</p><p><strong>Arguments</strong></p><ul><li><code>plot</code>: The plot object.</li></ul><p>The plot object can have the following optional arguments:</p><ul><li><code>color</code>: The color to be used for the plot. Can be a colorant, an attribute of the MTG, or a dictionary of colors for each reference mesh.</li><li><code>colorscheme</code>: The colorscheme to be used for the plot. Can be a Symbol or a ColorScheme.</li><li><code>facetcolor</code>: The color to be used for the facets. Should be a colorant or a symbol of color.</li><li><code>showfacets</code>: A boolean indicating whether the facets should be shown or not.</li><li><code>color_missing</code>: The color to be used for missing values. Should be a colorant or a symbol of color.</li><li><code>color_vertex</code>: A boolean indicating whether the values in <code>color</code> (if colored by attributes) are defined for each vertex of the mesh, or for each mesh.</li><li><code>index</code>: An integer giving the index of the attribute value to be vizualised. This is useful when the attribute is a vector of values for <em>e.g.</em> each timestep.</li><li><code>color_cache_name</code>: The name of the color cache. Should be a string (default to a random string).</li></ul><p><strong>Examples</strong></p><p>```julia using MultiScaleTreeGraph, PlantGeom, Colors</p><p>file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)</p><p>opf = read_opf(file)</p><p>f, a, plot = viz(opf) plot_opf(p)</p><p>f, a, plot = viz(opf, color=:red) plot_opf(plot)</p><p>f, a, plot = viz(opf, color=:Length) plot_opf(plot)</p><p>plot_opf(opf; color=Dict(1=&gt;RGB(0.1,0.5,0.1), 2=&gt;RGB(0.1,0.1,0.5)))</p><p>plot_opf(opf; color=:red, colorscheme=:viridis)</p><p>plot_opf(opf; color=:red, colorscheme=:viridis, facetcolor=:red, showfacets=true)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/opf/plot_opf.jl#L1-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.read_opf" href="#PlantGeom.read_opf"><code>PlantGeom.read_opf</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_opf(file, attr_type = Dict, mtg_type = MutableNodeMTG)</code></pre><p>Read an OPF file, and returns an MTG.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: The path to the opf file.</li><li><code>attr_type::DataType = Dict</code>: the type used to hold the attribute values for each node.</li><li><code>mtg_type = MutableNodeMTG</code>: the type used to hold the mtg encoding for each node (<em>i.e.</em></li></ul><p>link, symbol, index, scale). See details section below.</p><p><strong>Details</strong></p><p><code>attr_type</code> should be:</p><ul><li><code>NamedTuple</code> if you don&#39;t plan to modify the attributes of the mtg, <em>e.g.</em> to use them for</li></ul><p>plotting or computing statistics...</p><ul><li><code>MutableNamedTuple</code> if you plan to modify the attributes values but not adding new attributes</li></ul><p>very often, <em>e.g.</em> recompute an attribute value...</p><ul><li><code>Dict</code> or similar (<em>e.g.</em> <code>OrderedDict</code>) if you plan to heavily modify the attributes, <em>e.g.</em></li></ul><p>adding/removing attributes a lot</p><p>The <code>MultiScaleTreeGraph</code> package provides two types for <code>mtg_type</code>, one immutable (<a href="@ref"><code>MultiScaleTreeGraph.NodeMTG</code></a>), and one mutable (<a href="@ref"><code>MultiScaleTreeGraph.MutableNodeMTG</code></a>). If you&#39;re planning on modifying the mtg encoding of some of your nodes, you should use <a href="@ref"><code>MultiScaleTreeGraph.MutableNodeMTG</code></a>, and if you don&#39;t want to modify anything, use <a href="@ref"><code>MultiScaleTreeGraph.NodeMTG</code></a> instead as it should be faster.</p><p><strong>Note</strong></p><p>See the documentation of the MTG format from the MTG package documentation for further details, <em>e.g.</em> <a href="https://vezy.github.io/MultiScaleTreeGraph.jl/stable/the_mtg/mtg_concept/">The MTG concept</a>.</p><p><strong>Returns</strong></p><p>The MTG root node.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom
file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)
opf = read_opf(file)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/read_opf.jl#L1-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.refmesh_to_mesh" href="#PlantGeom.refmesh_to_mesh"><code>PlantGeom.refmesh_to_mesh</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">refmesh_to_mesh!(node)
refmesh_to_mesh(node)</code></pre><p>Compute a node mesh based on the reference mesh, the transformation matrix and the tapering. The mutating version adds the new mesh to the <code>mesh</code> field of the geometry attribute of the node.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom
file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)

node = opf[1][1][1]

new_mesh = refmesh_to_mesh(node)

using MeshViz, GLMakie
viz(new_mesh)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/refmesh_to_mesh.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.refmesh_to_mesh!" href="#PlantGeom.refmesh_to_mesh!"><code>PlantGeom.refmesh_to_mesh!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">refmesh_to_mesh!(node)
refmesh_to_mesh(node)</code></pre><p>Compute a node mesh based on the reference mesh, the transformation matrix and the tapering. The mutating version adds the new mesh to the <code>mesh</code> field of the geometry attribute of the node.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom
file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)

node = opf[1][1][1]

new_mesh = refmesh_to_mesh(node)

using MeshViz, GLMakie
viz(new_mesh)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/refmesh_to_mesh.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.rotate_point-NTuple{5, Any}" href="#PlantGeom.rotate_point-NTuple{5, Any}"><code>PlantGeom.rotate_point</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Rotate a point (x1,y1) around (x0, y0) with <code>angle</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/makie_recipes/mtg_recipe_helpers.jl#L113-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.taper-Tuple{Any, Any, Any}" href="#PlantGeom.taper-Tuple{Any, Any, Any}"><code>PlantGeom.taper</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Returns a tapered mesh using dDwn and dUp based on the geometry of an input mesh. Tapering a mesh transforms it into a tapered version (<em>i.e.</em> pointy) or enlarged object, <em>e.g.</em> make a cone from a cylinder.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/tapering.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.transform_mesh!-Tuple{MultiScaleTreeGraph.Node, Any}" href="#PlantGeom.transform_mesh!-Tuple{MultiScaleTreeGraph.Node, Any}"><code>PlantGeom.transform_mesh!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">transform_mesh!(node::Node, transformation)</code></pre><p>Add a new <code>CoordinateTransformations.jl</code> transformation to the node geometry <code>transformation</code> field. The transformation is composed with the previous transformation if any.</p><p><code>transformation</code> must be a <code>CoordinateTransformations.jl</code> transformation.</p><p>It is also possible to invert a transformation using <code>inv</code> from <code>CoordinateTransformations.jl</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom, MultiScaleTreeGraph, GLMakie, Rotations, CoordinateTransformations

file = joinpath(dirname(dirname(pathof(PlantGeom))), &quot;test&quot;, &quot;files&quot;, &quot;simple_plant.opf&quot;)
opf = read_opf(file)

# Visualize the mesh as is:
viz(opf)

# Copy the OPF, and translate the whole plant by 15 in the y direction (this is in cm, the mesh comes from XPlo):
opf2 = deepcopy(opf)
transform!(opf2, x -&gt; transform_mesh!(x, Translation(0, 15, 0)))
viz!(opf2) # Visualize it again in the same figure

# Same but rotate the whole plant around the X axis:
opf3 = deepcopy(opf)
transform!(opf3, x -&gt; transform_mesh!(x, LinearMap(RotX(0.3))))
# NB: we use Rotations.jl&#39;s RotX here. Input in radian, use rad2deg and deg2rad if needed.
viz!(opf3)

# Same but rotate only the second leaf around the Z axis:
opf4 = deepcopy(opf)
# Build the meshes from the reference meshes (need it because we want the coordinates of the parent):
transform!(opf4, refmesh_to_mesh!)

# Get the second leaf in the OPF:
leaf_node = get_node(opf4, 8)

# Get the parent node (internode) Z coordinates:
parent_zmax = zmax(leaf_node.parent)

# Define a rotation of the mesh around the Z axis defined by the parent node max Z:
transformation = recenter(LinearMap(RotZ(1.0)), Point3(0.0, 0.0, parent_zmax))

# Update the transformation matrix of the leaf and its mesh:
transform_mesh!(leaf_node, transformation)

# Plot the result:
viz(opf)
viz!(opf4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/transformations.jl#L10-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.write_opf-Tuple{Any, Any}" href="#PlantGeom.write_opf-Tuple{Any, Any}"><code>PlantGeom.write_opf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_opf(file, opf)</code></pre><p>Write an MTG with explicit geometry to disk as an OPF file.</p><p><strong>Notes</strong></p><p>Node attributes <code>:ref_meshes</code> and <code>:geometry</code> are treated as reserved keywords and should not be used without knowing their meaning:</p><ul><li><code>:ref_meshes</code>: a <code>RefMeshes</code> structure that holds the MTG reference meshes.</li><li><code>:geometry</code>: a <a href="#PlantGeom.geometry"><code>geometry</code></a> instance</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantGeom
file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
opf = read_opf(file)
write_opf(&quot;test.opf&quot;, opf)
opf2 = read_opf(&quot;test.opf&quot;)
viz(opf2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/opf/write_opf.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.xmax" href="#PlantGeom.xmax"><code>PlantGeom.xmax</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">xmax(x)
ymax(x)
zmax(x)</code></pre><p>Get the maximum x, y or z coordinates of a mesh or a Node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L15-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.xmin" href="#PlantGeom.xmin"><code>PlantGeom.xmin</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">xmin(x)
ymin(x)
zmin(x)</code></pre><p>Get the minimum x, y or z coordinates of a mesh or a Node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L24-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.ymax" href="#PlantGeom.ymax"><code>PlantGeom.ymax</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">xmax(x)
ymax(x)
zmax(x)</code></pre><p>Get the maximum x, y or z coordinates of a mesh or a Node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L15-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.ymin" href="#PlantGeom.ymin"><code>PlantGeom.ymin</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">xmin(x)
ymin(x)
zmin(x)</code></pre><p>Get the minimum x, y or z coordinates of a mesh or a Node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L24-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.zmax" href="#PlantGeom.zmax"><code>PlantGeom.zmax</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">xmax(x)
ymax(x)
zmax(x)</code></pre><p>Get the maximum x, y or z coordinates of a mesh or a Node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L15-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantGeom.zmin" href="#PlantGeom.zmin"><code>PlantGeom.zmin</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">xmin(x)
ymin(x)
zmin(x)</code></pre><p>Get the minimum x, y or z coordinates of a mesh or a Node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/meshes/summary_coordinates.jl#L24-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RecipesBase.plot" href="#RecipesBase.plot"><code>RecipesBase.plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot(opf::MultiScaleTreeGraph.Node; kwargs...)
plot!(opf::MultiScaleTreeGraph.Node; kwargs...)</code></pre><p>Make a diagram of the MTG tree, paired with a <code>Plots.jl</code> backend.</p><p>See also <a href="#PlantGeom.diagram"><code>diagram</code></a> for the same plot with a <code>Makie.jl</code> backend.</p><p><strong>Attributes</strong></p><ul><li><code>mode = &quot;2d&quot;</code>: The mode for plotting, either &quot;2d&quot; or &quot;3d&quot;</li><li><code>node_color = :black</code>: the node color, can be a color or any MTG attribute</li><li><code>edge_color = node_color</code>: same as <code>node_color</code>, but for the edges</li><li><code>colormap = :viridis</code>: the colormap used for coloring</li><li><code>color_missing = RGBA(0, 0, 0, 0.3)</code>: The color used for missing values</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># import Pkg; Pkg.add(&quot;PlotlyJS&quot;)
using Plots, PlantGeom
plotlyjs()

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)

opf = read_opf(file)

plot(opf, node_color = :Length)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/plots_recipes/plots_recipe.jl#L71-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RecipesBase.plot!" href="#RecipesBase.plot!"><code>RecipesBase.plot!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot(opf::MultiScaleTreeGraph.Node; kwargs...)
plot!(opf::MultiScaleTreeGraph.Node; kwargs...)</code></pre><p>Make a diagram of the MTG tree, paired with a <code>Plots.jl</code> backend.</p><p>See also <a href="#PlantGeom.diagram"><code>diagram</code></a> for the same plot with a <code>Makie.jl</code> backend.</p><p><strong>Attributes</strong></p><ul><li><code>mode = &quot;2d&quot;</code>: The mode for plotting, either &quot;2d&quot; or &quot;3d&quot;</li><li><code>node_color = :black</code>: the node color, can be a color or any MTG attribute</li><li><code>edge_color = node_color</code>: same as <code>node_color</code>, but for the edges</li><li><code>colormap = :viridis</code>: the colormap used for coloring</li><li><code>color_missing = RGBA(0, 0, 0, 0.3)</code>: The color used for missing values</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># import Pkg; Pkg.add(&quot;PlotlyJS&quot;)
using Plots, PlantGeom
plotlyjs()

file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;simple_plant.opf&quot;)
# file = joinpath(dirname(dirname(pathof(PlantGeom))),&quot;test&quot;,&quot;files&quot;,&quot;coffee.opf&quot;)

opf = read_opf(file)

plot(opf, node_color = :Length)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantGeom.jl/blob/5be46a1f89aa5b8e72d1c881fac53e57153d18dd/src/plots_recipes/plots_recipe.jl#L71-L101">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../makie_3d/">« 3D Makie recipes</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 26 March 2023 08:00">Sunday 26 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
